# Nachos实习报告：线程调度

<p align=right>
刘俊麟
1800013053
</p>
[toc]

## 1 任务完成情况

|   任务   | Exercise 1 | Exercise 2 | Exercise 3 | Challenge 1 |
| :------: | :--------: | :--------: | :--------: | :---------: |
| 完成情况 |     Y      |     Y      |     Y      |      Y      |

## 2 具体Exercise完成情况

### 2.1 Exercise 1 调研



### 2.2 Exercise 2 源代码阅读

在阅读实习说明中给出的几个文件之后，现总结其中的重点如下：

`code/threads/scheduler.h` 和 `code/threads/scheduler.cc` ：定义了 `Scheduler` 类，作为Nachos中的线程调度器。

- `readyList` : 类的主要成员，是类维护的一个FIFO的队列，存储状态为 `Ready` 的线程。
- `ReadyToRun()` : 将进程状态设置为 `Ready` 并放入 `readyList` 中。
- `FindNextToRun()` : 取出 `readyList` 中最靠前的线程，准备使其上CPU。
- `Run()` : 将旧进程的堆栈等信息保存后，进行线程切换，将新线程的状态信息加载到CPU，运行新线程。实际的信息拷贝等工作由汇编代码 `code/threads/switch.s` 完成。

`code/threads/switch.s` : CPU上进程切换的具体实现。首先保存了当前进程的状态，之后载入新进程的状态，然后切换到相应的栈空间，开始运行新线程。

`code/machine/timer.h` 和 `code/machine/timer.cc` : 

### 2.3 Exercise 3 线程调度算法扩展

### 2.4 Challenge 1 线程调度算法扩展 时间片轮转算法

## 3 遇到的困难以及收获

## 4 对课程或Lab的意见和建议

## 5 参考文献

